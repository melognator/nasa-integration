<template>
  <lightning-card title="Astronomical Picture of the Day" icon-name="custom:custom11">
    <div slot="actions">
      <template lwc:if={refreshApod}>
        <lightning-button-icon onclick={refreshApod}
            icon-name="utility:refresh"
        ></lightning-button-icon>
      </template>
    </div>
    <template lwc:if={loaded}>
      <template lwc:if={apod}>
        <template lwc:if={isImage}>
          <a target="_blank" class="apod-image-container" href={apod.URL__c}>
            <div class="slds-text-heading_medium">Click for full size</div>
            <img src={apod.URL__c} alt={apod.Name} />
          </a>
        </template>
        <template lwc:else>
          <div class="apod-video-container">
            <iframe src={apod.URL__c} frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
          </div>
        </template>
        <div slot="footer">
          <h2 class="slds-text-title_bold">{apod.Name}</h2>
          <p>{apod.Explanation__c}</p>
        </div>
      </template>
      <template lwc:else>
        <template lwc:if={pictureOfTheDay}>
          <p class="slds-m-bottom_x-small"
          >Seems like today's Astronomical Picture of the Day wasn't able to be retrieved.</p>
          <lightning-button label="Click here to retrieve" onclick={retrieveApod}></lightning-button>
        </template>
        <template lwc:else>
          <p>Something went wrong. Contact your administrator.</p>
        </template>
      </template>
    </template>
    <template lwc:else>
      <div class="apod-spinner-container">
        <lightning-spinner alternative-text="Loading" size="large"></lightning-spinner>
      </div>
    </template>
  </lightning-card>
</template>